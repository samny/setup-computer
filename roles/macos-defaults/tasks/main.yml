---
# Core macOS system preferences that are applied by default
# For optional/experimental settings, see optional.yml

- name: Set Finder to always show list view
  community.general.osx_defaults:
    domain: com.apple.finder
    key: FXPreferredViewStyle
    type: string
    value: "Nlsv"
    state: present

- name: Show all filename extensions
  community.general.osx_defaults:
    domain: NSGlobalDomain
    key: AppleShowAllExtensions
    type: bool
    value: true
    state: present

- name: Enable Dock auto-hide
  community.general.osx_defaults:
    domain: com.apple.dock
    key: autohide
    type: bool
    value: true
    state: present

- name: Set Dock icon size
  community.general.osx_defaults:
    domain: com.apple.dock
    key: tilesize
    type: float
    value: 48.0
    state: present

- name: Set default save location to Downloads
  community.general.osx_defaults:
    domain: com.apple.screencapture
    key: location
    type: string
    value: "{{ ansible_facts['env']['HOME'] }}/Downloads"
    state: present

- name: Restart Finder to apply changes
  ansible.builtin.command: killall Finder
  changed_when: true
  failed_when: false

- name: Restart Dock to apply changes
  ansible.builtin.command: killall Dock
  changed_when: true
  failed_when: false
